(this.webpackJsonptwitchsync=this.webpackJsonptwitchsync||[]).push([[0],{17:function(e,t,n){e.exports=n(37)},22:function(e,t,n){},23:function(e,t,n){e.exports=n.p+"static/media/logo.5d5d9eef.svg"},24:function(e,t,n){},37:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),i=n(15),r=n.n(i),c=(n(22),n(2)),s=n(5),l=n(3),d=(n(23),n(24),n(16)),u=n.n(d),v=n(6),f=n(4),h={bar:function(e){return{background:"#333333",height:e?52:0,display:e?"flex":"none",justifyContent:"center",flexDirection:"row",alignItems:"center"}},buttonContainer:{display:"flex",alignItems:"center"},button:function(e){return{background:"#bdbdbd",color:"#2b2b2b",padding:"1px 5px",fontSize:"13px",borderRadius:"2px",display:"flex",alignItems:"center",justifyContent:"center",pointer:"cursor",WebkitUserSelect:"none",MozUserSelect:"none",MsUserSelect:"none",height:"26px",boxShadow:e?"inset 1px 1px 3px ".concat("#9147ff",", inset -1px -1px 3px ").concat("#9147ff"):""}},link:{color:"#bdbdbd",textDecoration:"none"},control:{margin:"9px",color:"#bdbdbd",WebkitUserSelect:"none",MozUserSelect:"none",MsUserSelect:"none"},playPause:{width:"28px",height:"28px"},seek:{width:"18px",height:"18px"},angle:function(e){return{width:"20px",height:"20px",margin:"9px 9px",WebkitUserSelect:"none",MozUserSelect:"none",MsUserSelect:"none",borderRadius:"4px",padding:"7px",color:e?"black":"white",position:"absolute",right:0,zIndex:2}}},p=new RegExp(/(?:(\d+)h)?(?:(\d+)m)?(?:(\d+)s)?/),b=new RegExp(/^(\d\d\d\d\d\d\d\d\d)$|.*twitch\.tv\/videos\/(\d\d\d\d\d\d\d\d\d)$/);function g(e){var t,n=Object(l.a)(e);try{for(n.s();!(t=n.n()).done;){if(t.value.playing)return!0}}catch(a){n.e(a)}finally{n.f()}return!1}var m=function(){var e=o.a.useState(""),t=Object(s.a)(e,2),n=t[0],a=t[1];o.a.useEffect((function(){""===n&&fetch("https://id.twitch.tv/oauth2/token?client_id=".concat("fujozw3t5ht1ngho5vofkbw0pbvcmk","&client_secret=").concat("691czpgdus8fzag3lmezyl33rkvsu7","&grant_type=client_credentials"),{method:"POST"}).then((function(e){return e.json()})).then((function(e){return a(e.access_token)}))}));var i=o.a.useState({active:-1,vods:[]}),r=Object(s.a)(i,2),d=r[0],m=r[1],y=o.a.useRef(d.vods);y.current=d.vods;var x=o.a.useRef(d.active);x.current=d.active;var w=o.a.useState(""),j=Object(s.a)(w,2),E=j[0],k=j[1],O=o.a.useState(!0),S=Object(s.a)(O,2),C=S[0],T=S[1],R=o.a.useState(!0),z=Object(s.a)(R,2),I=z[0],B=z[1],M=o.a.useState(!0),D=Object(s.a)(M,2),U=D[0],_=D[1],P=o.a.useState(!0),W=Object(s.a)(P,2),L=W[0],A=W[1],G=o.a.useState(!0),N=Object(s.a)(G,2),$=(N[0],N[1],o.a.useState("")),H=Object(s.a)($,2),J=H[0],V=H[1],q=function(e,t,n,a,o){for(var i=e.width,r=e.height-(h.bar(a).height+h.bar(o).height),c={width:300*n,height:300},s=1;s<=t;s++){var l=Math.ceil(t/s);if(r*n/s>i/l){var d=i/l;d>c.width&&(c={width:d,height:d/n})}else{var u=r/s;u>c.height&&(c={width:u*n,height:u})}}return c}(function(){var e=o.a.useState({width:void 0,height:void 0}),t=Object(s.a)(e,2),n=t[0],a=t[1];return o.a.useEffect((function(){function e(){a({width:window.innerWidth,height:window.innerHeight})}return window.addEventListener("resize",e),e(),function(){return window.removeEventListener("resize",e)}}),[]),n}(),d.vods.length,16/9,U,L);return o.a.useEffect((function(){var e=setInterval((function(){try{if(C){for(var e=!1,t=-1,n=0;n<d.vods.length;n++){var a=d.vods[n].ref.current.getInternalPlayer();if(void 0!==a)a.getMuted()||(e=!0,n!==d.active&&(t=n))}-1!==t?(d.vods[t].muted=!1,-1!==d.active&&(d.vods[d.active].muted=!0),m({active:t,vods:d.vods})):m({active:e?d.active:-1,vods:d.vods})}}catch(J){m({active:-1,vods:y.current}),console.log(J)}}),50);return function(){return clearTimeout(e)}})),o.a.createElement("div",{style:{display:"flex",height:"100vh",width:"100vw",flexDirection:"column",background:"black"}},o.a.createElement("div",{style:Object(c.a)({},h.bar(U))},o.a.createElement("div",{style:{display:"flex",flexGrow:1,flexBasis:0,alignItems:"center"}},o.a.createElement("div",{style:{display:""===J?"none":"flex",alignItems:"center",marginLeft:"10px",marginRight:"10px",padding:"4px",fontSize:"13px",background:"#757575",boxShadow:"0 0 0 1px #b50000",borderRadius:"2px",maxHeight:"".concat(h.bar(!0).height-8,"px"),overflow:"scroll",boxSizing:"border-box"}},o.a.createElement("div",null,J),o.a.createElement(v.a,{icon:f.f,className:"closeError",style:{width:"13px",height:"13px",padding:"3px",marginLeft:"7px",borderRadius:"2px"},onClick:function(){V("")}}))),o.a.createElement("div",{style:h.buttonContainer},o.a.createElement("input",{type:"text",value:E,onChange:function(e){return k(e.target.value)},size:"50",placeholder:"http://twitch.tv/videos/123456789 or 123456789",style:{background:"#cfcfcf",border:"none",outline:"none",borderRadius:"2px",paddingLeft:"5px",height:h.button(!1).height}}),o.a.createElement("div",{style:Object(c.a)({},h.button(!1),{marginLeft:"5px"}),onClick:function(){var e=E.match(b);if(null!==e){var t=void 0===e[2]?e[1]:e[2];fetch("https://api.twitch.tv/helix/videos?id=".concat(t),{headers:{Authorization:"Bearer ".concat(n),"Client-Id":"fujozw3t5ht1ngho5vofkbw0pbvcmk"}}).then((function(e){return e.json()})).then((function(e){if(void 0===e.error){var n=e.data[0],a=new Date(n.created_at),i=new Date(a.getTime()+function(e){var t=e.match(p);return 1e3*parseInt(t[3])+60*parseInt(t[2])*1e3+60*parseInt(t[1])*60*1e3}(n.duration)),r=0===d.vods.length;m({active:r?0:d.active,vods:d.vods.concat({id:t,start:a,end:i,ref:o.a.createRef(),playing:!1,volume:.5,muted:!r,showButtons:!1,buttonTimeoutRef:o.a.createRef(),vodData:n})})}else V("API Error: ".concat(e.error,", message: ").concat(e.message," (status: ").concat(e.status,")"))})).catch((function(e){return V("Error adding video: ".concat(e))}))}else V('Could not parse video from text "'.concat(E,'"'));k("")}},"Add Video")),o.a.createElement("div",{style:{flexGrow:1,flexBasis:0,display:"flex",justifyContent:"flex-end",alignItems:"center"}},o.a.createElement("a",{href:"https://github.com/henryperson/twitchsync",style:Object(c.a)({},h.link,{marginRight:"20px",fontSize:"14px"})},"Source"),o.a.createElement("a",{href:"https://www.buymeacoffee.com/henryperson",style:Object(c.a)({},h.link,{marginRight:"60px",fontSize:"14px"})},"Buy Me Coffee"))),o.a.createElement(v.a,{className:"showhide",style:Object(c.a)({},h.angle(U),{top:0}),icon:U?f.b:f.a,onClick:function(){return _(!U)}}),o.a.createElement(v.a,{className:"showhide",style:Object(c.a)({},h.angle(L),{bottom:0}),icon:L?f.a:f.b,onClick:function(){return A(!L)}}),o.a.createElement("div",{style:{flexGrow:1,display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center",alignContent:"center",flexBasis:0,flexWrap:"wrap",minWidth:"0%"}},d.vods.map((function(e,t){return o.a.createElement("div",{key:t,style:{width:q.width,height:q.height,boxSizing:"border-box",padding:"2px",position:"relative"},onMouseEnter:function(){e.showButtons=!0,m({active:d.active,vods:d.vods}),null!==e.buttonTimeoutRef&&clearTimeout(e.buttonTimeoutRef.current),e.buttonTimeoutRef.current=setTimeout((function(){e.showButtons=!1,m({active:x.current,vods:y.current})}),2e3)}},o.a.createElement("div",{style:{position:"absolute",top:0,right:0,display:"flex",margin:"12px"},onMouseMove:function(){e.showButtons=!0,m({active:d.active,vods:d.vods}),null!==e.buttonTimeoutRef&&clearTimeout(e.buttonTimeoutRef.current),e.buttonTimeoutRef.current=setTimeout((function(){e.showButtons=!1,m({active:x.current,vods:y.current})}),2e3)}},o.a.createElement("div",{style:Object(c.a)({},h.button(!1),{marginRight:"10px",visibility:e.showButtons?"visible":"hidden"}),onClick:function(){var n=e.ref.current.getCurrentTime();console.log("currentSeconds",n);var a=new Date(e.start.getTime()+1e3*n);console.log("start",e.start),console.log("current time",a);for(var o=[],i=0;i<d.vods.length;i++){var r=d.vods[i];r.end<a||r.start>a?V("Cannot sync ".concat(r.vodData.user_name," (id ").concat(r.id,")")):i!==t&&o.push(r)}for(var c=0,s=o;c<s.length;c++){var l=s[c],u=(e.start-l.start)/1e3;l.ref.current.seekTo(n+u,"seconds")}}},"Sync To This"),o.a.createElement(v.a,{icon:f.f,style:Object(c.a)({},h.button(!1),{width:"16px",height:"16px",padding:"6px",visibility:e.showButtons?"visible":"hidden"}),onClick:function(){null!==e.buttonTimeoutRef&&clearTimeout(e.buttonTimeoutRef.current),d.vods.splice(t,1),m({active:d.active===t?-1:d.active,vods:d.vods})}})),o.a.createElement(u.a,{ref:e.ref,url:"https://www.twitch.tv/videos/"+e.id,width:"100%",height:"100%",controls:!0,config:{twitch:{options:{time:"0h0m0s",autoplay:!1}}},volume:e.volume,muted:e.muted,playing:e.playing,onPlay:function(){if(I){var t,n=Object(l.a)(d.vods);try{for(n.s();!(t=n.n()).done;){t.value.playing=!0}}catch(a){n.e(a)}finally{n.f()}}e.playing=!0,m({active:d.active,vods:d.vods})},onPause:function(){if(I){var t,n=Object(l.a)(d.vods);try{for(n.s();!(t=n.n()).done;){t.value.playing=!1}}catch(a){n.e(a)}finally{n.f()}}e.playing=!1,m({active:d.active,vods:d.vods})},progressInterval:1e3}))}))),o.a.createElement("div",{style:Object(c.a)({},h.bar(L))},o.a.createElement("div",{style:Object(c.a)({},h.buttonContainer,{flex:"1 0 0",justifyContent:"flex-start"})},o.a.createElement("div",{style:Object(c.a)({},h.button(!1),{margin:"10px"}),onClick:function(){if(d.vods.length>0){var e,t=d.vods[0],n=Object(l.a)(d.vods);try{for(n.s();!(e=n.n()).done;){var a=e.value;a.start>t.start&&(t=a)}}catch(f){n.e(f)}finally{n.f()}var o,i=Object(l.a)(d.vods);try{for(i.s();!(o=i.n()).done;){var r=o.value;if(r.end<t.start)return void V("Can't sync: ".concat(r.vodData.user_name," video (id ").concat(r.id,") ends before ").concat(t.vodData.user_name," video (id ").concat(t.id,") begins"))}}catch(f){i.e(f)}finally{i.f()}var c,s=Object(l.a)(d.vods);try{for(s.s();!(c=s.n()).done;){var u=c.value,v=(t.start-u.start)/1e3;u.ref.current.seekTo(v)}}catch(f){s.e(f)}finally{s.f()}}}},"Earliest Sync"),o.a.createElement("div",{style:Object(c.a)({},h.button(C),{margin:"10px",width:"95px"}),onClick:function(){return T(!C)}},"Smart Mute ",C?"On":"Off"),o.a.createElement("div",{style:Object(c.a)({},h.button(I),{margin:"10px",width:"95px"}),onClick:function(){return B(!I)}},"Smart Play ",I?"On":"Off")),o.a.createElement("div",{style:h.buttonContainer},o.a.createElement(v.a,{style:Object(c.a)({},h.control,{},h.seek),icon:f.g,onClick:function(){B(!0);var e,t=Object(l.a)(d.vods);try{for(t.s();!(e=t.n()).done;){e.value.playing=!0}}catch(r){t.e(r)}finally{t.f()}m({active:d.active,vods:d.vods});var n,a=Object(l.a)(d.vods);try{for(a.s();!(n=a.n()).done;){var o=n.value,i=o.ref.current.getCurrentTime();o.ref.current.seekTo(i-10)}}catch(r){a.e(r)}finally{a.f()}}}),o.a.createElement(v.a,{style:Object(c.a)({},h.control,{},h.playPause),icon:g(d.vods)?f.c:f.d,onClick:function(){B(!0);var e,t=g(d.vods),n=Object(l.a)(d.vods);try{for(n.s();!(e=n.n()).done;){e.value.playing=!t}}catch(a){n.e(a)}finally{n.f()}m({active:-1===d.active?0:d.active,vods:d.vods})}}),o.a.createElement(v.a,{style:Object(c.a)({},h.control,{},h.seek),icon:f.e,onClick:function(){B(!0);var e,t=Object(l.a)(d.vods);try{for(t.s();!(e=t.n()).done;){e.value.playing=!0}}catch(r){t.e(r)}finally{t.f()}m({active:d.active,vods:d.vods});var n,a=Object(l.a)(d.vods);try{for(a.s();!(n=a.n()).done;){var o=n.value,i=o.ref.current.getCurrentTime();o.ref.current.seekTo(i+10)}}catch(r){a.e(r)}finally{a.f()}}})),o.a.createElement("div",{style:Object(c.a)({},h.buttonContainer,{flex:"1 0 0",justifyContent:"flex-end"})})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(m,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[17,1,2]]]);
//# sourceMappingURL=main.47a8aa8f.chunk.js.map